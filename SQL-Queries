/*------------------------------------------------------------------------------------------------------------------------*/
/*The INNER JOIN keyword selects records that have matching values in both tables. */
SELECT * FROM EMPLOYEE AS EM INNER JOIN STUDENT AS ST ON EM.ID=ST.ID;

/* LEFT OUTER JOIN - RETURNS ALL THE RECORD FROM LEFT TABLE AND MATCHING RECORDS FROM RIGHT TABLE */
SELECT * FROM STUDENT AS STU LEFT JOIN EMPLOYEE AS EMP ON STU.ID=EMP.ID; 

/* RIGHT OUTER JOIN - RETURNS ALL THE RECORD FROM RIGHT TABLE AND MATCHING RECORDS FROM LEFT TABLE */
SELECT * FROM STUDENT AS STU RIGHT OUTER JOIN EMPLOYEE AS EMP ON STU.ID=EMP.ID;

/* FULL OUTER JOIN - DOES NOT WORK IN SQL SERVER SO WHAT WE DO WE CAN GO FOR LEFT OUTER JOIN AND RIGHT OUTER JOIN WITH UNION KEYWORD IT IS TREET AS AS FULL OUTER JOIN*/
SELECT *  FROM employee FULL JOIN student ON employee.id=student.id;

SELECT * FROM STUDENT AS STU LEFT OUTER JOIN EMPLOYEE AS EMP ON STU.ID=EMP.ID 
UNION
SELECT * FROM STUDENT AS STU RIGHT OUTER JOIN EMPLOYEE AS EMP ON STU.ID=EMP.ID;

/* SELF JOIN - SELF JOIN IS A REGULAR JOIN IN WHICH A TABLE IS JOINED TO ITSEF */

SELECT EMP2.FIRSTNAME AS EMPLOYEE_NAME, 
EMP1.FIRSTNAME AS MANAGER_NAME 
FROM EMPLOYEE AS EMP1 
JOIN EMPLOYEE AS EMP2 ON EMP1.ID=EMP2.MANAGERID;

SELECT EMP1.FIRSTNAME AS EMPLOYEE_NAME, 
EMP2.FIRSTNAME AS MANAGER_NAME 
FROM EMPLOYEE AS EMP1 
JOIN EMPLOYEE AS EMP2 ON EMP1.MANAGERID=EMP2.ID;

/* UNION  - UNION OPERATOR IS USED TO COMBINE/CONCATENATE THE RESULT TWO OR MORE SELECT STATEMENT 
WITHOUT RETURN ANY DUPLICATE ROWS AND KEEPS UNIQUE RECORDS 

BUT THERE IS A CONDITION IN UNION 
* SAME NUMBER OF COLUMN IN BOTH TABLE
* SAME DATA TYPE
* HAVE IN SAME ORDER

For practice using customer_a and customer_b table

*/
SELECT * FROM CUSTOMER_A;
SELECT * FROM CUSTOMER_B;
UPDATE CUSTOMER_B SET customer_city='gurgaon' WHERE CUSTOMER_id='100';

SELECT * FROM CUSTOMER_A 
UNION 
SELECT * FROM CUSTOMER_B;

SELECT * FROM CUSTOMER_A 
UNION ALL
SELECT * FROM CUSTOMER_B;


/* GROUP BY :- GROUP BY STATEMENT GROUPS THE ROWS THAT HAVE SAME VALUE
MAJORITY TIME ITS USED WITH AGGREATE FUNTIONS LIKE : COUNT() MAX() MIN() SUM() AVERAGE()

SEE YOU NEED TO GROUP THE COLUMN WHERE REPEATED VALUES -- TABHI TO GOURP HOGA 
 */
 SELECT * FROM PAYMENT;

SELECT MODE, SUM(AMOUT) FROM PAYMENT GROUP BY MODE;


/* HAVING CLAUSE :- HAVING CLAUSE IS USED TO APPLY FILTER ON GROUP BY BASED ON SPECIFIC CONDITION. 

IN CASE OF SELECT STATEMENT WE USE WHERE FILTER BUT IN CASE OF GOUP BY WE USE HAVING CLAUSE 
 */
 
 SELECT MODE, SUM(AMOUT) AS TOTAL FROM PAYMENT GROUP BY MODE HAVING TOTAL>=4000;
